<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="generator" content="Docusaurus">
<link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="BrainRex Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="BrainRex Blog Atom Feed">
<link rel="preconnect" href="https://www.google-analytics.com">
<script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-136383172-1","auto"),ga("send","pageview")</script>
<script async src="https://www.google-analytics.com/analytics.js"></script>
<link rel="stylesheet" href="https://use.typekit.net/ckb0rsm.css">
<link rel="stylesheet" href="https://at-ui.github.io/feather-font/css/iconfont.css">
<link rel="stylesheet" href="">

<title data-react-helmet="true">Unit Testing Your Vector Config Files | BrainRex</title>

<meta data-react-helmet="true" http-equiv="x-ua-compatible" content="ie=edge"><meta data-react-helmet="true" property="og:title" content="Unit Testing Your Vector Config Files | BrainRex"><meta data-react-helmet="true" name="description" content="Treating your Vector configuration files as code"><meta data-react-helmet="true" property="og:description" content="Treating your Vector configuration files as code"><meta data-react-helmet="true" property="og:image" content="https://developers.brainrex.com/img/open-graph.png"><meta data-react-helmet="true" property="twitter:image" content="https://developers.brainrex.com/img/open-graph.png"><meta data-react-helmet="true" name="twitter:image:alt" content="Image for Unit Testing Your Vector Config Files | BrainRex"><meta data-react-helmet="true" name="twitter:card" content="summary">

<link data-react-helmet="true" rel="shortcut icon" href="/img/favicon.ico">


<link rel="stylesheet" href="/styles.12041eb9.css">

</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}function e(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}var n=window.matchMedia("(prefers-color-scheme: dark)");n.addListener((function(n){null===e()&&t(n.matches?"dark":"")}));var a=e();null!==a?t(a):n.matches&&t("dark")}()</script>
<div id="__docusaurus">
<nav class="navbar navbar--light navbar--fixed-top navbarHideable_2ZIa"><div class="navbar__inner"><div class="navbar__items"><div aria-label="Navigation bar toggle" class="navbar__toggle" role="button" tabindex="0"><svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></div><a aria-current="page" class="navbar__brand active" href="/"></a><a class="navbar__item navbar__link" href="/docs/">Docs</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/blog/">Blog</a><a class="navbar__item navbar__link" target="_blank" rel="noopener noreferrer" href="https://oauth.brainrex.com/login?response_type=token&amp;client_id=4hthln1mbhs268cr3ubs39hhda&amp;redirect_uri=https://console.brainrex.com/index.html?action=login">Open Console</a></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link" title="Download" href="/releases/"><i class="feather icon-download"></i> <span class="badge badge--primary">new</span></a><a class="navbar__item navbar__link" title="GitHub" target="_blank" rel="noopener noreferrer" href="https://github.com/brainrexAPI"><i class="feather icon-github"></i> <span class="badge badge--secondary">3k</span></a><div class="react-toggle react-toggle--disabled displayOnlyInLargeViewport_16CL"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_keGJ moon_1gwN"></span></div><div class="react-toggle-track-x"><span class="toggle_keGJ sun_3CPA"></span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" disabled="" aria-label="Dark mode toggle" class="react-toggle-screenreader-only"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a aria-current="page" class="navbar__brand active" href="/"></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a class="navbar__item navbar__link" href="/docs/">Docs</a></li><li class="menu__list-item"><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/blog/">Blog</a></li><li class="menu__list-item"><a class="navbar__item navbar__link" target="_blank" rel="noopener noreferrer" href="https://oauth.brainrex.com/login?response_type=token&amp;client_id=4hthln1mbhs268cr3ubs39hhda&amp;redirect_uri=https://console.brainrex.com/index.html?action=login">Open Console</a></li><li class="menu__list-item"><a class="navbar__item navbar__link" href="/releases/">Download<span class="badge badge--primary">new</span></a></li><li class="menu__list-item"><a class="navbar__item navbar__link" target="_blank" rel="noopener noreferrer" href="https://github.com/brainrexAPI">GitHub<span class="badge badge--secondary">3k</span></a></li></ul></div></div></div></nav><div class="main-wrapper"><article class="blogPost_3zD9"><header class="hero domain-bg domain-bg--config header_1qzK"><div class="container headerContainer_2rhk"><div class="avatar avatar--lg avatar--vertical"><img class="avatar__photo avatar__photo--lg" src="https://github.com/Jeffail.png"><div class="avatar__intro"><div class="avatar__name"><a href="https://github.com/Jeffail" target="_blank" rel="author">Ashley</a> / <time pubdate="pubdate" datetime="2019-11-25T00:00:00.000Z">Nov 24th</time> / 3 min read</div></div></div><h1>Unit Testing Your Vector Config Files</h1><div class="headerTags_9qDx"><div class="tags_1Ys8"><a class="badge badge--rounded badge--pink" href="/blog/tags/type-announcement/">type: announcement</a><a class="badge badge--rounded badge--blue" href="/blog/tags/domain-config/">domain: config</a></div></div></div></header><div class="container container--narrow container--bleed margin-vert--xl"><section class="markdown"><p>Today we&#x27;re excited to announce beta support for unit testing Vector
configurations, allowing you to define tests directly within your Vector
configuration file. These tests are used to assert the output from topologies of
<a href="/docs/reference/transforms/">transform</a> components given certain input events, ensuring
that your configuration behavior does not regress; a very powerful feature for
mission-critical production pipelines that are collaborated on.</p><h2 id="example">Example</h2><p>Let&#x27;s look at a basic example that uses the <a href="/docs/reference/transforms/regex_parser/"><code>regex_parser</code>
transform</a> to parse log lines:</p><div class="code-header">vector.toml</div><pre><code class="language-toml">[sources.my_logs]
  type    = &quot;file&quot;
  include = [&quot;/var/log/my-app.log&quot;]

[transforms.parser]
  inputs = [&quot;my_logs&quot;]
  type   = &quot;regex_parser&quot;
  regex  = &quot;^(?P&lt;timestamp&gt;[\\w\\-:\\+]+) (?P&lt;level&gt;\\w+) (?P&lt;message&gt;.*)$&quot;

[[tests]]
  name = &quot;verify_regex&quot;

  [tests.input]
    insert_at = &quot;parser&quot;
    type = &quot;raw&quot;
    value = &quot;2019-11-28T12:00:00+00:00 info Hello world&quot;

  [[tests.outputs]]
    extract_from = &quot;parser&quot;

    [[tests.outputs.conditions]]
      type = &quot;check_fields&quot;
      &quot;timestamp.equals&quot; = &quot;2019-11-28T12:00:00+00:00&quot;
      &quot;level.equals&quot; = &quot;info&quot;
      &quot;message.equals&quot; = &quot;Hello world&quot;
</code></pre><p>And you can run the tests via the new <code>test</code> subcommand:</p><pre><code class="language-sh">$ vector test ./vector.toml
Running ./vector.toml tests
Test ./vector.toml: verify_regex ... passed
</code></pre><h2 id="why">Why?</h2><p>Many Vector configurations will be simple transformations across straight
forward pipelines (such as <a href="/docs/reference/sources/file/">tailing a file</a> and piping the
data to <a href="/docs/reference/sinks/aws_cloudwatch_logs/">AWS CloudWatch Logs</a>) and don&#x27;t really
need protection from regressions. However, Vector configs are capable of
expanding indefinitely with <a href="/docs/reference/transforms/">transforms</a> in order to solve as
much of your processing needs as possible.</p><p>As a config grows, and as the number of owners of a config grow, the potential
for regressions also grows just like a regular codebase. The lack of testing
capabilities of configuration driven services is therefore a common pain for
larger organizations. We hope that natively supporting unit tests in Vector
configs will preemptively solve this problem.</p><h2 id="getting-started">Getting Started</h2><p>To help you get started we put together two documentation pages:</p><ol><li><a href="/docs/setup/guides/unit-testing/">A unit testing guide</a></li><li><a href="/docs/reference/tests/">A reference of the unit testing config spec</a></li></ol><p>These should be everything you need and will be actively maintained as this
feature matures.</p><h2 id="feedback">Feedback</h2><p>We&#x27;re eager to hear your feedback! Unit testing, as a <code>beta</code> feature, is still
in an early phase and we need case studies and comments in order to ensure it
works well for everyone. Please let us know what you think either in our
<a href="https://chat.vector.dev/">community chat</a> or by
<a href="https://github.com/timberio/vector/issues/new">raising an issue</a>.</p></section><section class="panel bleed" style="text-align:center"><div class="mailingListTitle_2bf2"><i class="feather icon-mail"></i> BrainRex In Your Inbox!</div><p>Two emails on the 1st and 14th of the month. No spam, ever.</p><div class="mailing-list mailing-list--center mailing-list--lg"><form action="https://formspree.io/xqkevzld" method="post" class="mailing-list--form"><input type="email" class="input input--lg" name="email" placeholder="you@email.com"><button class="button button--primary button--lg" type="submit">Subscribe</button></form></div></section><div class="bleed margin-vert--xl"><nav class="pagination-nav"><div class="pagination-nav__item"></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/blog/windows-support"><h5 class="pagination-nav__link--sublabel">Next Post</h5><h4 class="pagination-nav__link--label">Windows Support Is Here! »</h4></a></div></nav></div></div></article></div><footer class="footer"><div class="container"><div class="row footer__links"><div class="col col--5 footer__col"><div class="margin-bottom--md"></div><div class="margin-bottom--md"><div class="mailing-list"><form action="https://formspree.io/xqkevzld" method="post" class="mailing-list--form"><input type="email" class="input input--undefined" name="email" placeholder="you@email.com" style="width:150px"><button class="button button--primary button--undefined" type="submit">Subscribe</button></form></div></div><div><a href="https://twitter.com/timberdotio" target="_blank"><i class="feather icon-twitter" alt="Vector&#x27;s Twitter"></i></a>    <a href="https://chat.vector.dev" target="_blank"><i class="feather icon-message-circle" alt="Vector&#x27;s Chat"></i></a>    <a href="https://github.com/timberio/vector" target="_blank"><i class="feather icon-github" alt="Vector&#x27;s Github Repo"></i></a>    <a href="https://vector.dev/blog/atom.xml" target="_blank"><i class="feather icon-rss" alt="Vector&#x27;s RSS feed"></i></a></div></div><div class="col footer__col"><h4 class="footer__title">About</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/docs/about/what-is-brainrex/">What is BrainRex?</a></li><li class="footer__item"><a class="footer__link-item" href="/community/#team">The Team</a></li><li class="footer__item"><a class="footer__link-item" href="/contact/">Contact Us</a></li><li class="footer__item"><a class="footer__link-item" href="/press/">Press</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">Products</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/docs/reference/sources/">Sources</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/reference/transforms/">Transforms</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/reference/sinks/">Sinks</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">Documentation</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/docs/setup/installation/">Install</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/setup/deployment/">Deployment</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/setup/configuration/">Configuration</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/administration/">Administration</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">Community</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" to="https://chat.vector.dev" href="https://chat.vector.dev">Chat</a></li><li class="footer__item"><a class="footer__link-item" to="https://github.com/brainrexAPI" href="https://github.com/brainrexAPI">Github</a></li><li class="footer__item"><a class="footer__link-item" to="https://twitter.com/brainrexAI" href="https://twitter.com/brainrexAI">Twitter</a></li><li class="footer__item"><a class="footer__link-item" to="https://www.linkedin.com/company/brainrex/" href="https://www.linkedin.com/company/brainrex/">Linkedin</a></li><li class="footer__item"><a aria-current="page" class="footer__link-item active" href="/blog/">Blog</a></li></ul></div></div><div class="text--center"><div class="margin-bottom--sm"><a href="https://brainrex.com/" target="_blank" rel="noopener noreferrer" class="footerLogoLink_3L_r"></a></div>Copyright © 2020 BrainRex, Ltd.</div></div></footer>
</div>

<script src="/styles.df23172f.js"></script>

<script src="/runtime~main.8abde316.js"></script>

<script src="/main.651451ed.js"></script>

<script src="/common.115dfc8b.js"></script>

<script src="/2.89f117cd.js"></script>

<script src="/4.ab569136.js"></script>

<script src="/ccc49370.592c1250.js"></script>

<script src="/6f526775.fb924ab2.js"></script>


</body>
</html>