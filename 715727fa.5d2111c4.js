/*! For license information please see 715727fa.5d2111c4.js.LICENSE */
(window.webpackJsonp=window.webpackJsonp||[]).push([[72],{172:function(e,t,n){"use strict";n.r(t),n.d(t,"frontMatter",(function(){return o})),n.d(t,"metadata",(function(){return s})),n.d(t,"rightToc",(function(){return b})),n.d(t,"default",(function(){return d}));var a=n(1),r=n(6),l=(n(0),n(254)),i=n(259),c=n(260),o={title:"Validating",description:"How to validation Vector's configuration to ensure it is error free before applying it."},s={id:"administration/validating",title:"Validating",description:"How to validation Vector's configuration to ensure it is error free before applying it.",source:"@site/docs/administration/validating.md",permalink:"/docs/administration/validating",editUrl:"https://github.com/timberio/vector/edit/master/website/docs/administration/validating.md",sidebar:"docs",previous:{title:"Updating",permalink:"/docs/administration/updating"},next:{title:"Glossary",permalink:"/docs/meta/glossary"}},b=[{value:"Validating Environment",id:"validating-environment",children:[]}],u={rightToc:b},p="wrapper";function d(e){var t=e.components,n=Object(r.a)(e,["components"]);return Object(l.b)(p,Object(a.a)({},u,n,{components:t,mdxType:"MDXLayout"}),Object(l.b)("p",null,"Vector provides a subcommand ",Object(l.b)("inlineCode",{parentName:"p"},"validate")," which checks the validity of any number\nof configuration files and then exits:"),Object(l.b)(i.a,{block:!0,defaultValue:"fields",values:[{label:"Fields Only",value:"fields"},{label:"Fields and Topology",value:"topology"}],mdxType:"Tabs"},Object(l.b)(c.a,{value:"fields",mdxType:"TabItem"},Object(l.b)("pre",null,Object(l.b)("code",Object(a.a)({parentName:"pre"},{className:"language-bash"}),"vector validate /etc/vector/vector.toml\n"))),Object(l.b)(c.a,{value:"topology",mdxType:"TabItem"},Object(l.b)("pre",null,Object(l.b)("code",Object(a.a)({parentName:"pre"},{className:"language-bash"}),"vector validate --topology /etc/vector/*.toml\n")))),Object(l.b)("p",null,"The validate subcommand checks the correctness of fields for components defined\nwithin a configuration file, including:"),Object(l.b)("ol",null,Object(l.b)("li",{parentName:"ol"},"All ",Object(l.b)("a",Object(a.a)({parentName:"li"},{href:"/docs/reference/sources/"}),"sources"),", ",Object(l.b)("a",Object(a.a)({parentName:"li"},{href:"/docs/reference/transforms/"}),"transforms"),", and\n",Object(l.b)("a",Object(a.a)({parentName:"li"},{href:"/docs/reference/sinks/"}),"sinks")," include all non-optional fields."),Object(l.b)("li",{parentName:"ol"},"All fields are of the proper ",Object(l.b)("a",Object(a.a)({parentName:"li"},{href:"/docs/setup/configuration/#value-types"}),"type"),".")),Object(l.b)("p",null,"If validation fails, Vector will exit with a ",Object(l.b)("inlineCode",{parentName:"p"},"78"),", and if validation succeeds\nVector will exit with a ",Object(l.b)("inlineCode",{parentName:"p"},"0"),"."),Object(l.b)("p",null,"These checks can be expanded with flags such as ",Object(l.b)("inlineCode",{parentName:"p"},"--topology"),", which causes\n",Object(l.b)("inlineCode",{parentName:"p"},"validate")," to also verify that the configuration file contains a valid topology,\nexpanding the above checks with the following:"),Object(l.b)("ol",{start:3},Object(l.b)("li",{parentName:"ol"},"At least one ",Object(l.b)("a",Object(a.a)({parentName:"li"},{href:"/docs/reference/sources/"}),"source")," is defined."),Object(l.b)("li",{parentName:"ol"},"At least one ",Object(l.b)("a",Object(a.a)({parentName:"li"},{href:"/docs/reference/sinks/"}),"sink")," is defined."),Object(l.b)("li",{parentName:"ol"},"All ",Object(l.b)("inlineCode",{parentName:"li"},"inputs")," values contain at least one value (cannot be empty)."),Object(l.b)("li",{parentName:"ol"},"All ",Object(l.b)("inlineCode",{parentName:"li"},"inputs")," values reference valid and upstream ",Object(l.b)("a",Object(a.a)({parentName:"li"},{href:"/docs/reference/sources/"}),"source")," or\n",Object(l.b)("a",Object(a.a)({parentName:"li"},{href:"/docs/reference/transforms/"}),"transform")," components.")),Object(l.b)("p",null,"To see other customization options for the ",Object(l.b)("inlineCode",{parentName:"p"},"validate")," subcommand run\n",Object(l.b)("inlineCode",{parentName:"p"},"vector validate --help"),"."),Object(l.b)("h2",{id:"validating-environment"},"Validating Environment"),Object(l.b)("p",null,"Vector also provides a ",Object(l.b)("inlineCode",{parentName:"p"},"--dry-run")," option which prevents regular execution and\ninstead validates a configuration file as well as the runtime environment:"),Object(l.b)(i.a,{block:!0,defaultValue:"config",values:[{label:"Config Only",value:"config"},{label:"Config + Healthchecks",value:"config_healthchecks"}],mdxType:"Tabs"},Object(l.b)(c.a,{value:"config",mdxType:"TabItem"},Object(l.b)("pre",null,Object(l.b)("code",Object(a.a)({parentName:"pre"},{className:"language-bash"}),"vector --config /etc/vector/vector.toml --dry-run\n"))),Object(l.b)(c.a,{value:"config_healthchecks",mdxType:"TabItem"},Object(l.b)("pre",null,Object(l.b)("code",Object(a.a)({parentName:"pre"},{className:"language-bash"}),"vector --config /etc/vector/vector.toml --dry-run --require-healthy\n")))),Object(l.b)("p",null,"If a dry run fails, Vector will exit with a ",Object(l.b)("inlineCode",{parentName:"p"},"78"),", and if it succeeds Vector\nwill exit with a ",Object(l.b)("inlineCode",{parentName:"p"},"0"),"."),Object(l.b)("p",null,"A dry run expands upon the ",Object(l.b)("inlineCode",{parentName:"p"},"validation")," checks above with the following:"),Object(l.b)("ol",{start:7},Object(l.b)("li",{parentName:"ol"},"All components are capable of running (data directories exist, are writable,\netc).")),Object(l.b)("p",null,"You'll notice in the second example above you can pass the ",Object(l.b)("inlineCode",{parentName:"p"},"--require-healthy"),"\nflag to also run health checks for all defined sinks."),Object(l.b)("ol",{start:8},Object(l.b)("li",{parentName:"ol"},"All ",Object(l.b)("a",Object(a.a)({parentName:"li"},{href:"/docs/reference/sinks/"}),"sinks")," are able to connect to their targets.")))}d.isMDXComponent=!0},253:function(e,t,n){var a;!function(){"use strict";var n={}.hasOwnProperty;function r(){for(var e=[],t=0;t<arguments.length;t++){var a=arguments[t];if(a){var l=typeof a;if("string"===l||"number"===l)e.push(a);else if(Array.isArray(a)&&a.length){var i=r.apply(null,a);i&&e.push(i)}else if("object"===l)for(var c in a)n.call(a,c)&&a[c]&&e.push(c)}}return e.join(" ")}e.exports?(r.default=r,e.exports=r):void 0===(a=function(){return r}.apply(t,[]))||(e.exports=a)}()},254:function(e,t,n){"use strict";n.d(t,"a",(function(){return u})),n.d(t,"b",(function(){return m}));var a=n(0),r=n.n(a);function l(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function c(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){l(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function o(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},l=Object.keys(e);for(a=0;a<l.length;a++)n=l[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(a=0;a<l.length;a++)n=l[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var s=r.a.createContext({}),b=function(e){var t=r.a.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):c({},t,{},e)),n},u=function(e){var t=b(e.components);return r.a.createElement(s.Provider,{value:t},e.children)},p="mdxType",d={inlineCode:"code",wrapper:function(e){var t=e.children;return r.a.createElement(r.a.Fragment,{},t)}},f=Object(a.forwardRef)((function(e,t){var n=e.components,a=e.mdxType,l=e.originalType,i=e.parentName,s=o(e,["components","mdxType","originalType","parentName"]),u=b(n),p=a,f=u["".concat(i,".").concat(p)]||u[p]||d[p]||l;return n?r.a.createElement(f,c({ref:t},s,{components:n})):r.a.createElement(f,c({ref:t},s))}));function m(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var l=n.length,i=new Array(l);i[0]=f;var c={};for(var o in t)hasOwnProperty.call(t,o)&&(c[o]=t[o]);c.originalType=e,c[p]="string"==typeof e?e:a,i[1]=c;for(var s=2;s<l;s++)i[s]=n[s];return r.a.createElement.apply(null,i)}return r.a.createElement.apply(null,n)}f.displayName="MDXCreateElement"},259:function(e,t,n){"use strict";var a=n(1),r=n(0),l=n.n(r),i=n(266),c=n(253),o=n.n(c),s=n(277),b=n.n(s);function u({block:e,centered:t,className:n,style:a,values:r,selectedValue:i,setSelectedValue:c}){return l.a.createElement("div",{className:t?"tabs--centered":""},l.a.createElement("ul",{className:o()("tabs",n,{"tabs--block":e}),style:a},r.map(({value:e,label:t})=>l.a.createElement("li",{className:o()("tab-item",{"tab-item--active":i===e}),key:e,onClick:()=>c(e)},t))))}function p({selectedValue:e,setSelectedValue:t,values:n}){return l.a.createElement(i.a,{className:"react-select-container",classNamePrefix:"react-select",options:n,isClearable:!1,placeholder:"Select a version...",value:n.find(t=>t.value==e),onChange:e=>t(e?e.value:null)})}t.a=function(e){const{block:t,centered:n,children:i,defaultValue:c,select:o,style:s,values:d,urlKey:f}=e,[m,v]=Object(r.useState)(c);return Object(r.useEffect)(()=>{if("undefined"!=typeof window&&window.location&&f){let e=b.a.parse(window.location.search);e[f]&&v(e[f])}},[]),l.a.createElement("div",null,d.length>1&&(o?l.a.createElement(p,Object(a.a)({selectedValue:m,setSelectedValue:v},e)):l.a.createElement(u,Object(a.a)({selectedValue:m,setSelectedValue:v},e))),l.a.createElement("div",{className:"margin-vert--md"},r.Children.toArray(i).filter(e=>e.props.value===m)[0]))}},260:function(e,t,n){"use strict";var a=n(0),r=n.n(a);t.a=function(e){return r.a.createElement("div",null,e.children)}}}]);