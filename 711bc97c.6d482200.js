(window.webpackJsonp=window.webpackJsonp||[]).push([[71],{171:function(e,a,t){"use strict";t.r(a),t.d(a,"frontMatter",(function(){return o})),t.d(a,"metadata",(function(){return u})),t.d(a,"rightToc",(function(){return d})),t.d(a,"default",(function(){return b}));var n=t(1),l=t(6),r=(t(0),t(254)),i=t(256),c=t(261),s=t(262),o={description:"The Vector `aws_ec2_metadata` transform accepts `log` events and allows you to enrich logs with AWS EC2 instance metadata.",event_types:["log"],issues_url:"https://github.com/timberio/vector/issues?q=is%3Aopen+is%3Aissue+label%3A%22transform%3A+aws_ec2_metadata%22",sidebar_label:'aws_ec2_metadata|["log"]',source_url:"https://github.com/timberio/vector/tree/master/src/transforms/aws_ec2_metadata.rs",status:"prod-ready",title:"AWS EC2 Metadata Transform"},u={id:"reference/transforms/aws_ec2_metadata",title:"AWS EC2 Metadata Transform",description:"The Vector `aws_ec2_metadata` transform accepts `log` events and allows you to enrich logs with AWS EC2 instance metadata.",source:"@site/docs/reference/transforms/aws_ec2_metadata.md",permalink:"/docs/reference/transforms/aws_ec2_metadata",editUrl:"https://github.com/timberio/vector/edit/master/website/docs/reference/transforms/aws_ec2_metadata.md",sidebar_label:'aws_ec2_metadata|["log"]',sidebar:"docs",previous:{title:"ANSI Stripper Transform",permalink:"/docs/reference/transforms/ansi_stripper"},next:{title:"Coercer Transform",permalink:"/docs/reference/transforms/coercer"}},d=[{value:"Configuration",id:"configuration",children:[]},{value:"Options",id:"options",children:[{value:"fields",id:"fields",children:[]},{value:"host",id:"host",children:[]},{value:"namespace",id:"namespace",children:[]},{value:"refresh_interval_secs",id:"refresh_interval_secs",children:[]}]},{value:"Output",id:"output",children:[{value:"ami-id",id:"ami-id",children:[]},{value:"availability-zone",id:"availability-zone",children:[]},{value:"instance-id",id:"instance-id",children:[]},{value:"local-hostname",id:"local-hostname",children:[]},{value:"local-ipv4",id:"local-ipv4",children:[]},{value:"public-hostname",id:"public-hostname",children:[]},{value:"public-ipv4",id:"public-ipv4",children:[]},{value:"region",id:"region",children:[]},{value:"role-name",id:"role-name",children:[]},{value:"subnet-id",id:"subnet-id",children:[]},{value:"vpc-id",id:"vpc-id",children:[]}]},{value:"How It Works",id:"how-it-works",children:[{value:"Environment Variables",id:"environment-variables",children:[]}]}],m={rightToc:d},p="wrapper";function b(e){var a=e.components,t=Object(l.a)(e,["components"]);return Object(r.b)(p,Object(n.a)({},m,t,{components:a,mdxType:"MDXLayout"}),Object(r.b)("p",null,"The Vector ",Object(r.b)("inlineCode",{parentName:"p"},"aws_ec2_metadata")," transform accepts ",Object(r.b)("a",Object(n.a)({parentName:"p"},{href:"/docs/about/data-model/log/"}),Object(r.b)("inlineCode",{parentName:"a"},"log"))," events and allows you to enrich logs with AWS EC2 instance metadata."),Object(r.b)("h2",{id:"configuration"},"Configuration"),Object(r.b)(i.a,{fileName:"vector.toml",learnMoreUrl:"/docs/setup/configuration/",mdxType:"CodeHeader"}),Object(r.b)("pre",null,Object(r.b)("code",Object(n.a)({parentName:"pre"},{className:"language-toml"}),'[transforms.my_transform_id]\n  # REQUIRED\n  type = "aws_ec2_metadata" # must be: "aws_ec2_metadata"\n  inputs = ["my-source-id"] # example\n\n  # OPTIONAL\n  fields = ["instance-id", "local-hostname", "local-ipv4", "public-hostname", "public-ipv4", "ami-id", "availability-zone", "vpc-id", "subnet-id", "region"] # default\n  host = "http://169.254.169.254" # default\n  namespace = "" # default\n  refresh_interval_secs = 10 # default\n')),Object(r.b)("h2",{id:"options"},"Options"),Object(r.b)(c.a,{filters:!0,mdxType:"Fields"},Object(r.b)(s.a,{common:!0,defaultValue:["instance-id","local-hostname","local-ipv4","public-hostname","public-ipv4","ami-id","availability-zone","vpc-id","subnet-id","region"],enumValues:null,examples:[["instance-id","local-hostname","local-ipv4","public-hostname","public-ipv4","ami-id","availability-zone","vpc-id","subnet-id","region"]],name:"fields",nullable:!0,path:null,relevantWhen:null,required:!1,templateable:!1,type:"[string]",unit:null,mdxType:"Field"},Object(r.b)("h3",{id:"fields"},"fields"),Object(r.b)("p",null,"A list of fields to include in each event.")),Object(r.b)(s.a,{common:!0,defaultValue:"http://169.254.169.254",enumValues:null,examples:["http://169.254.169.254"],name:"host",nullable:!0,path:null,relevantWhen:null,required:!1,templateable:!1,type:"string",unit:null,mdxType:"Field"},Object(r.b)("h3",{id:"host"},"host"),Object(r.b)("p",null,"Override the default EC2 Metadata host.")),Object(r.b)(s.a,{common:!0,defaultValue:"",enumValues:null,examples:[""],name:"namespace",nullable:!0,path:null,relevantWhen:null,required:!1,templateable:!1,type:"string",unit:null,mdxType:"Field"},Object(r.b)("h3",{id:"namespace"},"namespace"),Object(r.b)("p",null,"Prepend a namespace to each field's key.")),Object(r.b)(s.a,{common:!0,defaultValue:10,enumValues:null,examples:[10],name:"refresh_interval_secs",nullable:!0,path:null,relevantWhen:null,required:!1,templateable:!1,type:"int",unit:null,mdxType:"Field"},Object(r.b)("h3",{id:"refresh_interval_secs"},"refresh_interval_secs"),Object(r.b)("p",null,"The interval in seconds at which the EC2 Metadata api will be called."))),Object(r.b)("h2",{id:"output"},"Output"),Object(r.b)("p",null,"The ",Object(r.b)("inlineCode",{parentName:"p"},"aws_ec2_metadata")," transform accepts ",Object(r.b)("a",Object(n.a)({parentName:"p"},{href:"/docs/about/data-model/log/"}),Object(r.b)("inlineCode",{parentName:"a"},"log"))," events and allows you to enrich logs with AWS EC2 instance metadata.\nFor example:"),Object(r.b)("pre",null,Object(r.b)("code",Object(n.a)({parentName:"pre"},{className:"language-javascript"}),'{\n  "ami-id": "ami-00068cd7555f543d5",\n  "availability-zone": "54.234.246.107",\n  "instance-id": "i-096fba6d03d36d262",\n  "local-hostname": "ip-172-31-93-227.ec2.internal",\n  "local-ipv4": "172.31.93.227",\n  "public-hostname": "ec2-54-234-246-107.compute-1.amazonaws.com",\n  "public-ipv4": "54.234.246.107",\n  "region": "us-east-1",\n  "role-name": "some_iam_role",\n  "subnet-id": "subnet-9d6713b9",\n  "vpc-id": "vpc-a51da4dc"\n}\n')),Object(r.b)("p",null,"More detail on the output schema is below."),Object(r.b)(c.a,{filters:!0,mdxType:"Fields"},Object(r.b)(s.a,{defaultValue:null,enumValues:null,examples:["ami-00068cd7555f543d5"],name:"ami-id",path:null,required:!1,type:"string",mdxType:"Field"},Object(r.b)("h3",{id:"ami-id"},"ami-id"),Object(r.b)("p",null,"The ",Object(r.b)("inlineCode",{parentName:"p"},"ami-id")," that the current EC2 instance is using.")),Object(r.b)(s.a,{defaultValue:null,enumValues:null,examples:["54.234.246.107"],name:"availability-zone",path:null,required:!1,type:"string",mdxType:"Field"},Object(r.b)("h3",{id:"availability-zone"},"availability-zone"),Object(r.b)("p",null,"The ",Object(r.b)("inlineCode",{parentName:"p"},"availability-zone")," that the current EC2 instance is running in.")),Object(r.b)(s.a,{defaultValue:null,enumValues:null,examples:["i-096fba6d03d36d262"],name:"instance-id",path:null,required:!1,type:"string",mdxType:"Field"},Object(r.b)("h3",{id:"instance-id"},"instance-id"),Object(r.b)("p",null,"The ",Object(r.b)("inlineCode",{parentName:"p"},"instance-id")," of the current EC2 instance.")),Object(r.b)(s.a,{defaultValue:null,enumValues:null,examples:["ip-172-31-93-227.ec2.internal"],name:"local-hostname",path:null,required:!1,type:"string",mdxType:"Field"},Object(r.b)("h3",{id:"local-hostname"},"local-hostname"),Object(r.b)("p",null,"The ",Object(r.b)("inlineCode",{parentName:"p"},"local-hostname")," of the current EC2 instance.")),Object(r.b)(s.a,{defaultValue:null,enumValues:null,examples:["172.31.93.227"],name:"local-ipv4",path:null,required:!1,type:"string",mdxType:"Field"},Object(r.b)("h3",{id:"local-ipv4"},"local-ipv4"),Object(r.b)("p",null,"The ",Object(r.b)("inlineCode",{parentName:"p"},"local-ipv4")," of the current EC2 instance.")),Object(r.b)(s.a,{defaultValue:null,enumValues:null,examples:["ec2-54-234-246-107.compute-1.amazonaws.com"],name:"public-hostname",path:null,required:!1,type:"string",mdxType:"Field"},Object(r.b)("h3",{id:"public-hostname"},"public-hostname"),Object(r.b)("p",null,"The ",Object(r.b)("inlineCode",{parentName:"p"},"public-hostname")," of the current EC2 instance.")),Object(r.b)(s.a,{defaultValue:null,enumValues:null,examples:["54.234.246.107"],name:"public-ipv4",path:null,required:!1,type:"string",mdxType:"Field"},Object(r.b)("h3",{id:"public-ipv4"},"public-ipv4"),Object(r.b)("p",null,"The ",Object(r.b)("inlineCode",{parentName:"p"},"public-ipv4")," of the current EC2 instance.")),Object(r.b)(s.a,{defaultValue:null,enumValues:null,examples:["us-east-1"],name:"region",path:null,required:!1,type:"string",mdxType:"Field"},Object(r.b)("h3",{id:"region"},"region"),Object(r.b)("p",null,"The ",Object(r.b)("a",Object(n.a)({parentName:"p"},{href:"#region"}),Object(r.b)("inlineCode",{parentName:"a"},"region"))," that the current EC2 instance is running in.")),Object(r.b)(s.a,{defaultValue:null,enumValues:null,examples:["some_iam_role"],name:"role-name",path:null,required:!1,type:"string",mdxType:"Field"},Object(r.b)("h3",{id:"role-name"},"role-name"),Object(r.b)("p",null,"The ",Object(r.b)("inlineCode",{parentName:"p"},"role-name")," that the current EC2 instance is using.")),Object(r.b)(s.a,{defaultValue:null,enumValues:null,examples:["subnet-9d6713b9"],name:"subnet-id",path:null,required:!1,type:"string",mdxType:"Field"},Object(r.b)("h3",{id:"subnet-id"},"subnet-id"),Object(r.b)("p",null,"The ",Object(r.b)("inlineCode",{parentName:"p"},"subnet-id")," of the current EC2 instance's default network interface.")),Object(r.b)(s.a,{defaultValue:null,enumValues:null,examples:["vpc-a51da4dc"],name:"vpc-id",path:null,required:!1,type:"string",mdxType:"Field"},Object(r.b)("h3",{id:"vpc-id"},"vpc-id"),Object(r.b)("p",null,"The ",Object(r.b)("inlineCode",{parentName:"p"},"vpc-id")," of the current EC2 instance's default network interface."))),Object(r.b)("h2",{id:"how-it-works"},"How It Works"),Object(r.b)("h3",{id:"environment-variables"},"Environment Variables"),Object(r.b)("p",null,"Environment variables are supported through all of Vector's configuration.\nSimply add ",Object(r.b)("inlineCode",{parentName:"p"},"${MY_ENV_VAR}")," in your Vector configuration file and the variable\nwill be replaced before being evaluated."),Object(r.b)("p",null,"You can learn more in the ",Object(r.b)("a",Object(n.a)({parentName:"p"},{href:"/docs/setup/configuration/#environment-variables"}),"Environment Variables"),"\nsection."))}b.isMDXComponent=!0},254:function(e,a,t){"use strict";t.d(a,"a",(function(){return d})),t.d(a,"b",(function(){return h}));var n=t(0),l=t.n(n);function r(e,a,t){return a in e?Object.defineProperty(e,a,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[a]=t,e}function i(e,a){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);a&&(n=n.filter((function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable}))),t.push.apply(t,n)}return t}function c(e){for(var a=1;a<arguments.length;a++){var t=null!=arguments[a]?arguments[a]:{};a%2?i(Object(t),!0).forEach((function(a){r(e,a,t[a])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):i(Object(t)).forEach((function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(t,a))}))}return e}function s(e,a){if(null==e)return{};var t,n,l=function(e,a){if(null==e)return{};var t,n,l={},r=Object.keys(e);for(n=0;n<r.length;n++)t=r[n],a.indexOf(t)>=0||(l[t]=e[t]);return l}(e,a);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(n=0;n<r.length;n++)t=r[n],a.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(l[t]=e[t])}return l}var o=l.a.createContext({}),u=function(e){var a=l.a.useContext(o),t=a;return e&&(t="function"==typeof e?e(a):c({},a,{},e)),t},d=function(e){var a=u(e.components);return l.a.createElement(o.Provider,{value:a},e.children)},m="mdxType",p={inlineCode:"code",wrapper:function(e){var a=e.children;return l.a.createElement(l.a.Fragment,{},a)}},b=Object(n.forwardRef)((function(e,a){var t=e.components,n=e.mdxType,r=e.originalType,i=e.parentName,o=s(e,["components","mdxType","originalType","parentName"]),d=u(t),m=n,b=d["".concat(i,".").concat(m)]||d[m]||p[m]||r;return t?l.a.createElement(b,c({ref:a},o,{components:t})):l.a.createElement(b,c({ref:a},o))}));function h(e,a){var t=arguments,n=a&&a.mdxType;if("string"==typeof e||n){var r=t.length,i=new Array(r);i[0]=b;var c={};for(var s in a)hasOwnProperty.call(a,s)&&(c[s]=a[s]);c.originalType=e,c[m]="string"==typeof e?e:n,i[1]=c;for(var o=2;o<r;o++)i[o]=t[o];return l.a.createElement.apply(null,i)}return l.a.createElement.apply(null,t)}b.displayName="MDXCreateElement"},256:function(e,a,t){"use strict";var n=t(0),l=t.n(n);t(85);a.a=function({fileName:e,links:a}){let t=[];for(var n in a)t.push(l.a.createElement("a",{href:n.href},n.text||"Learn more&hellip;"));return l.a.createElement("div",{className:"code-header"},t.length>0&&l.a.createElement("span",{className:"code-header--links"},t),e)}},258:function(e,a,t){"use strict";(function(e){var n=t(1),l=t(0),r=t.n(l),i=t(275),c=t(267),s=t.n(c),o=t(265),u=t(253),d=t.n(u),m=t(274),p=t.n(m),b=t(268),h=t.n(b),f=t(255),v=t(86),O=t.n(v),y=t(263);(void 0!==e?e:window).Prism=o.a,t(269),t(270),t(271),t(272),t(273);const g=/{([\d,-]+)}/;a.a=({children:e,className:a,metastring:t})=>{const{siteConfig:{themeConfig:{prism:c={}}}}=Object(f.a)(),[o,u]=Object(l.useState)(!1),m=Object(l.useRef)(null),b=Object(l.useRef)(null),[v]=Object(y.a)();let j=[];if(t&&g.test(t)){const e=t.match(g)[1];j=h.a.parse(e).filter(e=>e>0)}Object(l.useEffect)(()=>{let e;return b.current&&(e=new s.a(b.current,{target:()=>m.current})),()=>{e&&e.destroy()}},[b.current,m.current]);let E=a&&a.replace(/language-/,"");!E&&c.defaultLanguage&&(E=c.defaultLanguage);const w=()=>{window.getSelection().empty(),u(!0),setTimeout(()=>u(!1),2e3)};let N="dark"==v?c.darkTheme:c.theme;return r.a.createElement(i.a,Object(n.a)({},i.b,{theme:N||p.a,code:e.trim(),language:E}),({className:e,style:a,tokens:t,getLineProps:l,getTokenProps:i})=>r.a.createElement("div",{className:O.a.codeBlockWrapper},r.a.createElement("pre",{ref:m,className:d()(e,O.a.codeBlock),style:a},t.map((e,a)=>{const t=l({line:e,key:a});return j.includes(a+1)&&(t.className=`${t.className} docusaurus-highlight-code-line`),r.a.createElement("div",Object(n.a)({key:a},t),e.map((e,a)=>r.a.createElement("span",Object(n.a)({key:a},i({token:e,key:a})))))})),r.a.createElement("button",{ref:b,type:"button","aria-label":"Copy code to clipboard",className:O.a.copyButton,onClick:w},o?"Copied":"Copy")))}}).call(this,t(48))},261:function(e,a,t){"use strict";var n=t(0),l=t.n(n);t(87);a.a=function({children:e,filters:a}){const[t,r]=Object(n.useState)(!1),[i,c]=Object(n.useState)(!1),[s,o]=Object(n.useState)(null);let u=Array.isArray(e)?e:[e],d=u.some(e=>e.props.common),m=u.some(e=>e.props.required),p=u;return t&&(p=p.filter(e=>e.props.common)),i&&(p=p.filter(e=>e.props.required)),s&&(p=p.filter(e=>e.props.name.toLowerCase().includes(s.toLowerCase()))),l.a.createElement("div",{className:"fields"},u.length>1&&!1!==a?l.a.createElement("div",{className:"filters"},l.a.createElement("span",{className:"result-count"},p.length," items"),l.a.createElement("div",{className:" search"},l.a.createElement("input",{type:"text",onChange:e=>o(e.currentTarget.value),placeholder:"\ud83d\udd0d Search..."})),l.a.createElement("div",{className:"checkboxes"},d&&l.a.createElement("label",{title:"Only show popular/common results"},l.a.createElement("input",{type:"checkbox",onChange:e=>r(e.currentTarget.checked),checked:t}),"common only"),m&&l.a.createElement("label",{title:"Only show required results"},l.a.createElement("input",{type:"checkbox",onChange:e=>c(e.currentTarget.checked),checked:i}),"required only"))):null,l.a.createElement("div",{className:"section-list"},!Array.isArray(p)||p.length>0?p:l.a.createElement("div",{className:"empty"},l.a.createElement("div",{className:"icon"},"\u2639"),l.a.createElement("div",null,"No fields found"))))}},262:function(e,a,t){"use strict";t(12);var n=t(0),l=t.n(n),r=t(253),i=t.n(r),c=(t(254),t(256)),s=t(258);function o(e){return JSON.stringify(e)}function u(e){return e.includes(".")?'"'+e+'"':e}function d(e,a){return(t=a)&&t.constructor===Object?"name"in a&&"value"in a?`${u(a.name)} = ${o(a.value)}`:`${u(Object.keys(a)[0])} = ${o(Object.values(a)[0])}`:e?`${e} = ${o(a)}`:`${o(a)}`;var t}function m({values:e}){let a=[];if(Array.isArray(e))for(var t in e){let n=e[t];a.push(l.a.createElement("code",{key:n},o(n))),a.push(" ")}else for(var n in e)a.push(l.a.createElement("code",{key:n,title:e[n]},o(n))),a.push(" ");return a}function p({name:e,path:a,value:t}){return l.a.createElement("code",null,d(null,t))}function b({name:e,path:a,values:t}){let n="";return t.forEach((function(a){n+=d(e,a)+"\n"})),a&&(n=`[${a}]\n${n}`),l.a.createElement("div",null,l.a.createElement(c.a,{fileName:"vector.toml"}),l.a.createElement(s.a,{className:"language-toml"},n))}function h({value:e}){let a=Object.keys(e)[0],t=Object.values(e)[0];return l.a.createElement("span",null,l.a.createElement("code",null,l.a.createElement("a",{href:`#${a}`},a))," = ",l.a.createElement("code",null,o(t)))}function f({defaultValue:e,enumValues:a,examples:t,name:r,path:i,relevantWhen:c}){const[s,o]=Object(n.useState)(!1);return e||a||t&&t.length>0?l.a.createElement("div",{className:"info"},void 0!==e?e?l.a.createElement("div",null,"Default: ",l.a.createElement(p,{name:r,path:i,value:e})):l.a.createElement("div",null,"No default"):null,a?l.a.createElement("div",null,"Enum, must be one of: ",l.a.createElement(m,{values:a})):null,c?l.a.createElement("div",null,"Only relevant when: ",l.a.createElement(h,{value:c})):null,l.a.createElement("div",null,l.a.createElement("div",{className:"show-more",onClick:()=>o(!s)},s?"Hide examples":"View examples"),s&&l.a.createElement("div",{className:"examples"},l.a.createElement(b,{name:r,path:i,values:t})))):null}a.a=function({children:e,common:a,defaultValue:t,enumValues:r,examples:c,name:s,path:o,relevantWhen:u,templateable:d,type:m,unit:p,required:b}){const[h,v]=Object(n.useState)(!1);let O=e;return h&&(O=O.filter(e=>"p"!=e.props.originalType)),l.a.createElement("div",{className:i()("field","section",b?"field-required":"",h?"field-collapsed":""),required:b},l.a.createElement("div",{className:"badges"},a&&l.a.createElement("span",{className:"badge badge--primary",title:"This is a popular that we recommend for getting started"},"common"),d&&l.a.createElement("span",{className:"badge badge--primary",title:"This option is dynamic and accepts the Vector template syntax"},"templateable"),l.a.createElement("span",{className:"badge badge--secondary"},m),r&&Object.keys(r).length>0&&l.a.createElement("span",{className:"badge badge--secondary",title:"This option is an enumation and only allows specific values"},"enum"),p&&l.a.createElement("span",{className:"badge badge--secondary"},p),b?l.a.createElement("span",{className:"badge badge--danger"},"required"):l.a.createElement("span",{className:"badge badge--secondary"},"optional")),O,!h&&l.a.createElement(f,{defaultValue:t,enumValues:r,examples:c,name:s,path:o,relevantWhen:u}))}}}]);